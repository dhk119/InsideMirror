<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>일촌목록</title>
<link rel="stylesheet" href="/css/font.css">
<link rel="stylesheet" href="/css/minihomepage.css">
<link rel="stylesheet" href="/css/layout.css">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons"
	rel="stylesheet">
<script src="/js/sweetalert.min.js"></script>
<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
<style>
.content-menu ul {
	margin: 5px;
	padding: 0;
	list-style-type: none;
	overflow: hidden;
}

.content-menu>ul {
	background-color: transparent;
	display: block;
}

.content-menu ul>li {
	float: left;
	width: 70px;
}

.content-menu ul>li>a {
	display: block;
	height: 30px;
	line-height: 30px;
	text-decoration: none;
	font-size: 18px;
	border: 1px solid #000;
	border-top-right-radius: 10px;
	border-top-left-radius: 10px;
	cursor: pointer;
}

.content-menu>ul>li>a {
	color: #092e20;
}

.content-menu>ul>li>a:hover {
	font-weight: 1000;
}

.Ilchon-list>div {
	list-style-type: none;
	margin-left: 100px;
}

.list {
	float: left;
	margin-top: 30px;
}

.list2 {
	float: right;
	margin-top: 7px;
}

.content-menu>ul>li:nth-child(n+2) {
	background-color: #bfe6fa;
}

.material-icons {
	float: left;
	margin-top: 15px;
	background-color: transparent;
	border: none;
	cursor: pointer;
	margin-left: 50px;
}

.friend-box {
	border: 1px solid gray;
}

.friend-title>span {
	margin-left: 80px;
}

.btn-secondary {
	float: right;
	margin-top: 15px;
}
</style>
</head>
<body>
	<div class="bookcover">
		<div class="bookdot">
			<div class="page">
				<div class="profile-container">
					<div class="header1 profile-title">
						TOTAL <span class="color-red">0</span>
					</div>
					<div class="box profile-box">
						<div class="profile-image">
							<img class="profile-image-img" src="/image/cyworld1.png"
								alt="Profile Image">
						</div>
						<div class="profile-text">ㄴr는.. 오늘도.. 눈물을.. 흘린ㄷr..★</div>
						<div class="profile-username">
							<span style="color: #0f1b5c">채연</span> (♪♬)
						</div>
						<div class="profile-dropdown">
							<div class="dropdown-button">
								<div class="friend-Ilchon">일촌하기</div>
								<div class="friend-title">일촌목록</div>
								<div class="triangle-down"></div>
							</div>
							<div class="dropdown-content">
								<a href="#">ㅁㅁㅁ의 홈피</a> <a href="#">ㅁㅁㅁ의 홈피</a> <a href="#">ㅁㅁㅁ의
									홈피</a>
							</div>
						</div>
					</div>
				</div>
				<div class="content-container">
					<div class="header1 content-title">
						<div class="content-title-name">ㅁㅁㅁ님의 홈피</div>
					</div>
					<div class="box content-box">
						<div class="box-title">일촌관리 ></div>
						<div class="content-menu">
							<ul>
								<li><a href=" ">일촌목록</a></li>
								<li><a href="/friend/friendrequest">일촌신청</a></li>
							</ul>
						</div>
						<div class="friend-box">
							<div class="friend-title">
								<span>이름</span>
								<button class="material-icons" data-url="#">home</button>
								<button class="btn-secondary"
									onclick="confirmDeleteComment(this)">일촌삭제</button>
							</div>
						</div>
						<div th:if="${friendList.isEmpty()}">
							<p>일촌이 없습니다.</p>
						</div>
						<th:block th:each="friend : ${friendList}">
							<div class="friend-box">
								<div class="friend-title">
									이름 <span th:text="${friend.friendNickName}"></span>
									<button class="material-icons" data-url="#">home</button>
									<button class="btn-secondary"
										onclick="confirmDeleteComment(this)">일촌삭제</button>
								</div>
							</div>
						</th:block>
					</div>
				</div>
			</div>
			<div class="menu-container">
				<div class="menu-button">
					<a href="/member/minihomepage"><button>홈</button></a> <a
						href="/board/list?reqPage=1"><button>자유게시판</button></a> <a
						href="#"><button>사진첩</button></a> <a href="/guest/guestbookList"><button>방명록</button></a>
					<a href="#"><button>선물가게</button></a> <a href="#"><button>구매목록</button></a>
					<a href="#"><button>일촌관리</button></a> <a href="#"><button>고객센터</button></a>
					<a href="#"><button>즐겨찾기</button></a>
				</div>
			</div>
		</div>
	</div>
	</div>
	<script>
		//친구 삭제 확인
		function confirmDeleteComment(button) {
			const guestMemberNo = document.getElementById('guestMemberNo').innerHTML;

			if (!guestMemberNo) {
				console.error('친구 번호가 없습니다.');
				return;
			}

			if (confirm('일촌을 삭제하시겠습니까?')) {
				deleteComment(button);
			}
		}
		// 친구 삭제버튼
		function deleteComment(button) {
			const guestbookBox = button.closest('.guestbook-box');
			const guestMemberNo = $('#guestMemberNo').text();

			if (!guestMemberNo) {
				console.error('친구 번호 가 없습니다.');
				return;
			}

			$.ajax({
				type : 'GET',
				url : `/guest/deleteComment?guestMemberNo=${guestMemberNo}`,
				success : function(response) {
					guestbookBox.remove();
				},
				error : function(error) {
					alert('일촌 삭제 중 오류가 발생했습니다.');
				}
			});
		}
		
	</script>
</body>
</html>