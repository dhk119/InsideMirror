<!DOCTYPE html>
<html lang="ko">
<style>
    .board-wrap{
        width: 100%;
        height: 700px;
        font-size: 18px;
        /* background-color: #92a2ff; */
    }

    ul{
        padding: 0;
        margin: 0;
        list-style-type: none;
    }
    a{
        text-decoration: none;
        color: black;
    }

    .left{
        float: left;
    }
    .right{
        float: right;
    }

    .view-title-wrap{
        width: 100%;
        height: 100px;
        /* background-color: aqua; */
        overflow: hidden;
    }

    .view-title{
        width: 60%;
        height: 70px;
        /* background-color: blueviolet; */
        border-bottom: 1px solid black;
        border-right: 1px solid black;
        box-sizing: border-box;
        line-height: 70px;
    }
    .view-writer{
        width: 20%;
        height: 35px;
        /* background-color: #92a2ff; */
        border-bottom: 1px solid black;
        /* border-right: 1px solid black; */
        box-sizing: border-box;
        padding-left: 5px
    }
    .view-count{
        width: 20%;
        height: 35px;
        /* background-color: #0f1b5c; */
        box-sizing: border-box;
        border-bottom: 1px solid black;
    }
    .view-date{
        width: 25%;
        height: 35px;
        /* background-color: yellow; */
        box-sizing: border-box;
        border-bottom: 1px solid black;
        /* border-right: 1px solid black; */
        padding-left: 5px;
    }
    .view-mark{
        width: 15%;
        height: 35px;
        /* background-color: yellowgreen; */
        box-sizing: border-box;
        border-bottom: 1px solid black;
        text-align: center;
    }
    .fix{
        width: 100%;
        height: 30px;
        /* background-color: blue; */
        box-sizing: border-box;
        border-bottom: 1px solid black;
        text-align: right;
    }
    .fix>.material-icons{
        margin-right: 15px;
        cursor: pointer;
        padding-top: 3px;
    }
    
    .view-mark>span{
        font-size: 30px;
        cursor: pointer;
        display: none;
        margin: 0px 5px;
    }
    .view-mark>.select{
        display: inline-block;
    }
    
    .view-count>span{
        float: left;
        margin-left: 10px;
    }
    .view-count>span:not(.material-icons){
        line-height: 35px;
    }
    .view-count>.material-icons{
        margin-top: 5px;
    }


    .view-content-wrap{
        width: 100%;
        height: 450px;
        /* background-color: aquamarine; */
    }
    .view-comment-wrap{
        width: 100%;
        height: 110px;
        /* background-color: beige; */
    }

    .comment-header{
        overflow: hidden;
    }
    .edited{
        margin-left: 5px;
        color: #a8a8a8;
        font-weight: 400;
        font-size: 18px;
    }
    .comment-content{
        overflow: hidden;
    }
    #comment{
        width: 80%;
        height: 100px;
        resize: none;
        outline: none;
        box-sizing: border-box;
        font-size: 15px;
        padding-left: 5px;
        margin-top: 10px;
    }
    #submit-btn{
        width: 15%;
        height: 100px;
        margin-left: 15px;
        margin-top: 10px;
    }
    .view-content-wrap>div{
        padding-top: 5px;
    }
    /* .comment-profile-image{
        width: 15%;
        height: 100px;
    } */
    .comment-writer{
        width: 100%;
        height: 30px;
        /* background-color: #b5c0ff; */
        margin-top: 10px;
    }

    .comment-profile-image>.material-icons{
        font-size: 100px;
    }

    .comment-list{
        width: 100%;
        height: 500px;
        margin-top: 20px;
    }

    .comment-list-content{
        width: 100%;
        overflow: hidden;
        max-height: 110px;
        /* padding-bottom: 20px; */
        border-bottom: 1px solid #ccc;
        position: relative;
        margin-bottom: 20px;
    }
    .more{
        position: absolute;
        right: 0px;
        bottom: 5px;
        width: 60px;
        height: 30px;
        border: none;
        background-color: #cff4ff;
        border-radius: 20px;
        cursor: pointer;
    }
    .more:hover{
        background-color: #6bdcff;
    }


    .edit, .remove{
        margin-right: 10px;
    }

    .reCommentBox{
        display: none;
    }

    .reComment-content>textarea{
        width: 70%;
        height: 100px;
        resize: none;
    }
    .comment-list-wrap:last-child>.comment-list-content{
        height: 50px;
        padding-bottom: 80px;
    }
</style>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>minihomepage</title>
    <link rel="stylesheet" href="/css/minihomepage.css">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/font.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
</head>

<body>
    
    <div class="bookcover">
        <div class="bookdot">
            <div class="page">
                <div class="profile-container">
                    <div class="header profile-title">TOTAL
                        <span class="color-red">28</span>
                    </div>
                    <div class="box profile-box">
                        <div class="profile-image">
                            <img class="profile-image-img" src="/image/cyworld1.png" alt="프로필 이미지">
                        </div>
                        <div class="profile-text">ㄴr는.. 오늘도.. 눈물을.. 흘린ㄷr..★</div>
                        <div class="profile-username">
                            <span style="color: #0f1b5c">채연</span>
                            (♪♬)
                        </div>
                        <div class="profile-dropdown">
                            <div class="dropdown-button">
                                <div class="dropdown-title">일촌 파도타기</div>
                                <div class="triangle-down"></div>
                            </div>
                            <div class="dropdown-content">
                                <a href="#">ㅁㅁㅁ의 홈피</a>
                                <a href="#">ㅁㅁㅁ의 홈피</a>
                                <a href="#">ㅁㅁㅁ의 홈피</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content-container">
                    <div class="header content-title">
                        <div class="content-title-name">ㅁㅁㅁ님의 홈피</div>
                    </div>
                    <div class="box content-box">
                    
                        <div class="box-title">자유 게시판 ></div>
                        
                        <div class="board-wrap">
                            <div class="view-title-wrap">

                                <div class="view-title left">
                                    <span th:text="${board.boardTitle}"></span>
                                </div>
                                
                                <div class="view-writer left">
                                    <span th:text="${board.boardWriter}"></span>
                                </div>

                                <div class="view-count left">
                                    <span class="material-icons">visibility</span>
                                    <span th:text="${board.readCount}"></span>
                                    <span class="material-icons">favorite</span>
                                    <span th:text="${board.boardLike}"></span>
                                </div>

                                <div class="view-date left">
                                    <span th:text="${board.boardDate}"></span>
                                </div>

                                <div class="view-mark left">
                                    <span class="material-icons">favorite</span>
                                    <span class="material-icons select">favorite_border</span>
                                    <span class="material-icons">bookmark</span>
                                    <span class="material-icons select">bookmark_border</span>

                                </div>

                                <div class="fix left">
                                    <span class="material-icons">edit</span>
                                    <span class="material-icons">delete</span>
                                </div>

                            </div>
                            <div class="view-content-wrap">
                                <div th:text="${board.boardContent}"></div>
                            </div>

                            <!-- 나중에 session 체크 해서 댓글 작성 넣기 -->
                            <!-- != null 먼저 체크 해야함 &&로 -->
                            <div class="view-comment-wrap">

                                <div class="comment-header">
                                    
                                </div>
                                
                                <div class="comment-content">

                                    <form action="/board/comment/" method="post">
                                        <textarea name="boardCommentContent" id="comment" class="left"></textarea>
                                        <input type="hidden" name="boardNo" th:value="${board.boardNo}">
                                        <input type="hidden" name="memberNo" th:if="${session.member != null}" th:value="${session.member.memberNo}">
                                        <button type="submit" id="submit-btn" class="left">작성하기</button>
                                    </form>
                                </div>
                            </div>
                            
                            <div class="comment-list">
                                <th:block th:each="bc : ${board.commentList}">
                                    <div class="comment-list-wrap">
                                        <!-- <div class="comment-profile-image left">
                                            <span class="material-icons">account_box</span>
                                        </div> -->
                                        <!-- 프사 -->
    
                                        <div class="comment-writer left">
                                            <div th:text="${bc.memberNo}" class="left"></div>
                                            <div class="edited left">(수정)</div>
                                            <!-- 나중에 th:if로 수정되었으면 감지해서 이 div 띄우기 -->
                                            <div th:text="${bc.boardCommentDate}" class="left"></div>
                                            <!-- 나중에 th로 답글 개수 조회해와서 넣기 -->
                                            <span class="getReCommentCount right">(0)</span>
                                            <a href="javascript:void(0)" class="getReComment right">답글</a>
                                            <a href="javascript:void(0)" class="remove right" th:onclick="">삭제</a>
                                            <a href="javascript:void(0)" class="edit right" th:onclick="">수정</a>
                                        </div>
    
                                        <div class="comment-list-content left" th:text="${bc.boardCommentContent}"></div>
    
                                    </div>
                                        <!-- 답글 -->
                                        <!-- 나중에 != null로 -->
                                    <div class="reComment-input-wrap">
                                        <div th:if="${session.member == null}" class="reCommentBox">
                                            <form action="/board/comment/" method="post">
                                                <div>
                                                    <!-- <input type="hidden" name="memberNo" th:value="${session.member.memberNo}"> -->
                                                    <input type="hidden" name="boardNo" th:value="${board.boardNo}">
                                                    <input type="hidden" name="boardCommentRef" th:value="${bc.boardCommentNo}">
                                                </div>
                                                <div class="reComment-content">
                                                    <textarea name="boardCommentContent"></textarea>
                                                </div>
                                            </form>
                                        </div>
                                    </div>

                                    <div class="reComment-list-wrap" th:each="bcc : ${board.reCommentList}" th:if="${bc.boardCommentNo == bcc.boardCommentRef}">
                                        <!-- 답글 출력 -->
                                        <div class="reComment-list" style="display: none;">
                                            <p class="comment-info">
                                                <span th:text="${bcc.memberNo}"></span>
                                                <span th:text="${bcc.boardCommentDate}"></span>
                                                <p class="reComment-content-list" th:text="${bcc.boardCommentContent}"></p>
                                            </p>

                                        </div>
                                    </div>





                                </th:block>
                                    

                            </div>
                                
                                
                        </div>   

                    </div>
                        
                </div>



                
                <div class="menu-container">
                    <div class="menu-button">
                        <a href="#"><button>홈</button></a>
                        <a href="/board/list?reqPage=1"><button>자유게시판</button></a>
                        <a href="#"><button>사진첩</button></a>
                        <a href="#"><button>방명록</button></a>
                        <a href="#"><button>선물가게</button></a>
                        <a href="#"><button>구매목록</button></a>
                        <a href="#"><button>일촌관리</button></a>
                        <a href="#"><button>고객센터</button></a>
                        <a href="#"><button>즐겨찾기</button></a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const longComment = $(".comment-list-content");
        longComment.each(function(index,item){
            const longCommentHeight = $(item).css("height");
            if(longCommentHeight === '110px'){
                const more = $("<button class='more'>더보기</button>");
                $(item).append(more);
            }
        });

        $(".more").on("click",function(){
            $(this).parent().css("max-height","1000px");
            $(this).remove();
        })

        //답글누르면 답글 쓸 수 있는 거랑 답글들 리스트 뜨기
        $(".getReComment").on("click",function(){
            const item = $(this);
            $(".getReComment").not(item).text("답글");
            $(".getReComment").not(item).parent().parent().next().children("div").hide();
            if(item.text() === "답글"){
                item.text("그만보기");
                item.prev().hide();
                item.parent().parent().next().children("div").show();
                // 답글 보여주기
                item.parent().parent().next().next().children("div").show();
            }
            else{
                item.text("답글");
                item.prev().show();
                item.parent().parent().next().children("div").hide();
            }
        })

    </script>

</body>

</html>