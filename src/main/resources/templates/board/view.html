<!DOCTYPE html>
<html lang="ko">
<style>

    .board-wrap{
        width: 100%;
        height: 700px;
        font-size: 18px;
        /* background-color: #92a2ff; */
    }

    ul{
        padding: 0;
        margin: 0;
        list-style-type: none;
    }
    a{
        text-decoration: none;
        color: black;
    }
    p{
        margin: 0;
    }

    .left{
        float: left;
    }
    .right{
        float: right;
    }

    .view-title-wrap{
        width: 100%;
        height: 130px;
        /* background-color: aqua; */
        overflow: hidden;
    }
    
    .view-title{
        width: 100%;
        height: 60px;
        /* background-color: blueviolet; */
        border-bottom: 1px solid rgb(132, 132, 132);
        box-sizing: border-box;
        line-height: 60px;
    }
    .view-etc{
        width: 100%;
        height: 40px;
        border-bottom: 1px solid rgb(132, 132, 132);
        box-sizing: border-box;
    }

    .view-writer{
        /* width: 30%; */
        width: auto;
        padding-right: 10px;
        height: 40px;
        /* background-color: #92a2ff; */
        /* border-right: 1px solid black; */
        line-height: 40px;
    }
    .view-date{
        width: 22%;
        height: 40px;
        line-height: 40px;
        /* background-color: yellow; */
        /* border-right: 1px solid black; */
    }

    .view-count{
        /* width: 20%; */
        width: auto;
        height: 40px;
        line-height: 40px;
        /* background-color: #0f1b5c; */
    } 
    .view-mark{
        width: 15%;
        height: 40px;
        /* background-color: yellowgreen; */
        text-align: center;
    }
    
    
    
    .view-mark>span{
        line-height: 40px;
        font-size: 30px;
        cursor: pointer;
        display: none;
        margin: 0px 5px;
    }
    .view-mark>.select{
        display: inline-block;
    }
    
    .view-count>.material-icons{
        margin: 0px 5px;
        height: 40px;
        line-height: 40px;
    }


    .view-content-wrap{
        width: 100%;
        min-height: 450px;
        height: auto;
        /* background-color: aquamarine; */
    }
    .view-comment-wrap{
        width: 100%;
        height: 110px;
        /* background-color: beige; */
    }

    .comment-header{
        overflow: hidden;
    }
    .edited{
        margin-left: 5px;
        color: #a8a8a8;
        font-weight: 400;
        font-size: 18px;
    }
    .comment-content{
        overflow: hidden;
    }
    #comment{
        width: 80%;
        height: 100px;
        resize: none;
        outline: none;
        box-sizing: border-box;
        font-size: 15px;
        padding-left: 5px;
        margin-top: 10px;
    }
    #submit-btn{
        width: 15%;
        height: 100px;
        margin-left: 15px;
        margin-top: 10px;
    }
    .view-content-wrap>div{
        padding-top: 5px;
    }
    /* .comment-profile-image{
        width: 15%;
        height: 100px;
    } */
    .comment-writer{
        width: 100%;
        height: 30px;
        /* background-color: #b5c0ff; */
        margin-top: 10px;
    }

    .comment-profile-image>.material-icons{
        font-size: 100px;
    }

    .comment-list{
        width: 100%;
        /* height: 10px; */
        margin-top: 20px;
        padding-bottom: 50px;
        height: auto;
        overflow: auto;
    }
    .comment-list-wrap{
        width: 100%;
        height: 90px;
        height: auto;
        overflow: auto;
        border-bottom: 1px solid #ccc;
    }


    .comment-list-content{
        width: 100%;
        overflow: hidden;
        max-height: 110px;
        /* padding-bottom: 20px; */
        position: relative;
    }
    .short-content{
        padding-bottom: 10px;
    }

    .size-btn{
        position: absolute;
        right: 0px;
        bottom: 5px;
        width: 60px;
        height: 30px;
        border: none;
        background-color: #cff4ff;
        border-radius: 20px;
        cursor: pointer;
    }
    .size-btn:hover{
        background-color: #6bdcff;
    }

    .content-hover:hover>button{
        opacity: 0.3;
    }



    .edit, .remove{
        margin-right: 10px;
    }

    .reCommentBox{
        display: none;
    }
    .reComment-content{
        width: 100%;
        height: 100px;
        overflow: hidden;
    }
    .reComment-submit{
        width: 10%;
        height: 90px;
        margin-left: 20px;
    }
    
    .reComment-content>textarea{
        width: 80%;
        height: 90px;
        resize: none;
        box-sizing: border-box;
        outline: none;
    }


    .comment-list-wrap:last-child>.comment-list-content{
        height: 50px;
        padding-bottom: 80px;
    }

    .edit-comment-content{
        resize: none;
        width: 100%;
        font-size: 18px;
        margin-bottom: 20px;
        outline: none;
        box-sizing: border-box;
    }
    .date{
        margin-left: 10px;
    }
    .rcDate{
        margin-left: 5px;
    }

    .reComment-list{
        border-bottom: 1px solid #ccc;
        padding-left: 20px;
    }
    
    .no-comment{
        text-align: center;
        line-height: 110px;
        color: #a8a8a8;
    }

    .fix{
        width: 100%;
        height: 30px;
        /* background-color: blue; */
        box-sizing: border-box;
        border-bottom: 1px solid rgb(148, 148, 148);
        text-align: right;
        display: flex;
    }


    .fix-wrap{
        width: 50%;
        height: 30px;
        display: flex;
        justify-content: right;
        align-items: center;
        gap: 10px;
    }

    .back-wrap{
        width: 55%;
        height: 30px;
        display: flex;
        justify-content: left;
        align-items: center;
    }

    .back-btn{
        float: left;

    }

    .fix-wrap>.material-icons{
        margin-right: 15px;
        cursor: pointer;
    }

</style>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>minihomepage</title>

</head>

<body>
    
    <th:block th:include="common/top"></th:block>
                    
    <div class="box-title">자유 게시판 ></div>
    
    <div class="board-wrap">
        <div class="view-title-wrap">

            <div class="view-title left">
                <span th:text="${board.boardTitle}"></span>
            </div>
            
            <div class="view-etc left">

                <div class="view-date right">
                    <span th:text="${board.boardDate}"></span>
                </div>

                <div class="view-writer right">
                    <span th:text="${board.boardWriter}"></span>
                    <span> | </span>
                </div>
                
                
                <div class="view-count left">
                    <span class="material-icons left">visibility</span>
                    <div th:text="${board.readCount}" class="left"></div>
                    <span class="material-icons left">favorite</span>
                    <div th:text="${board.boardLike}" class="left"></div>
                </div>

                <div class="view-mark left">
                    <span th:text="${board.isLike}"></span>
                    <span th:if="${board.isLike == 1}" class="material-icons select" th:onclick="pushLike(this,[[${board.boardNo}]])">favorite</span>
                    <span th:if="${board.isLike == 0}" class="material-icons select" th:onclick="pushLike(this,[[${board.boardNo}]])">favorite_border</span>
                    <span th:if="${board.isBookMark == 1}" class="material-icons select" th:onclick="pushBookMark(this,[[${board.boardNo}]])">bookmark</span>
                    <span th:if="${board.isBookMark == 0}" class="material-icons select" th:onclick="pushBookMark(this,[[${board.boardNo}]])">bookmark_border</span>
                </div>
            </div>
<!-- 작성자 | 작성일 -->
<!-- 조회수/하트개수 | 하트 | 북마크 순으로 -->
            <div class="fix left">
                <div class="back-wrap">
                    <button onclick="history.back()" class="back-btn">돌아가기</button>
                </div>

                <div class="fix-wrap right">
                    <span th:if="${session.member != null && session.member.memberNo == board.memberNo}" class="material-icons" th:onclick="boardEdit([[${board.boardNo}]],[[${board.boardTitle}]],[[${board.boardContent}]])">edit</span>
                    <span th:if="${session.member != null && session.member.memberNo == board.memberNo}" class="material-icons" th:onclick="boardDelete([[${board.boardNo}]])">delete</span>
                </div>
            </div>
            



        </div>
        <div class="view-content-wrap">
            <div th:utext="${board.boardContent}"></div>
        </div>

        

        <!-- 나중에 session 체크 해서 댓글 작성 넣기 -->
        <!-- != null 먼저 체크 해야함 &&로 -->
        <div class="view-comment-wrap">

            <div class="comment-header">
                
            </div>
            
            <div class="comment-content" th:if="${session.member != null}">
                <textarea name="boardCommentContent" id="comment" class="left"></textarea>
                <input type="hidden" name="boardNo" th:value="${board.boardNo}">
                <input type="hidden" name="memberNo" th:if="${session.member != null}" th:value="${session.member.memberNo}">
                <button type="button" id="submit-btn" class="left" onclick="addComment(this)">작성하기</button>
            </div>

            <div class="no-comment" th:if="${session.member == null}">
                <div>로그인 후 댓글 이용이 가능합니다!</div>
            </div>

        </div>
        
        <div class="comment-list">
            <th:block th:each="bc : ${board.commentList}">
                <div class="comment-list-wrap">

                    <!-- 프사 -->

                    <div class="comment-writer left">
                        <div th:text="${bc.boardCommentWriter}" class="writer left"></div>
                        <div th:if="${bc.boardEdit == 1}" class="edited left">(수정)</div>
                        <div th:text="${bc.boardCommentDate}" class="date left"></div>
                        <span class="right">)</span>
                        <span class="getReCommentCount right" th:text="${bc.reCommentCount}"></span>
                        <span class="right">(</span>
                        <a href="javascript:void(0)" class="getReComment right">답글</a>
                        <th:block th:if="${session.member != null && session.member.memberNo == bc.memberNo}">
                            <a href="javascript:void(0)" class="remove right" th:onclick="removeComment(this,[[${bc.boardCommentNo}]],[[${board.boardNo}]],[[${bc.boardCommentRef}]])">삭제</a>
                            <a href="javascript:void(0)" class="edit right" th:onclick="editComment(this,[[${bc.boardCommentNo}]],[[${board.boardNo}]],[[${bc.boardCommentRef}]])">수정</a>
                        </th:block>
                    </div>
                    
                    <div class="content-both comment-list-content content-hover left" th:text="${bc.boardCommentContent}"></div>

                </div>
                    <!-- 답글 -->
                <div class="reComment-input-wrap">
                    <div class="reCommentBox">
                        <div class="reComment-content">
                            <input type="hidden" name="boardCommentRef" th:value="${bc.boardCommentNo}">
                            <textarea name="boardCommentContent" class="left"></textarea>
                            <input type="hidden" name="boardNo" th:value="${board.boardNo}">
                            <input type="hidden" name="memberNo" th:value="${session.member.memberNo}">
                            <button type="button" class="reComment-submit left" onclick="addComment(this)">답글</button>
                        </div>
                    </div>

                    <div class="reComment-list-wrap" th:each="bcc : ${board.reCommentList}" th:if="${bc.boardCommentNo == bcc.boardCommentRef}">
                        <!-- 답글 출력 -->
                        <div class="reComment-list" style="display: none;">
                            <p class="comment-info">
                                <span th:text="${bcc.boardCommentWriter}" class="writer"></span>
                                <span th:if="${bcc.boardEdit == 1}" class="edited">(수정)</span>
                                <span th:text="${bcc.boardCommentDate}" class="rcDate"></span>
                                <th:block th:if="${session.member != null && session.member.memberNo == bc.memberNo}">
                                    <a href="javascript:void(0)" class="remove right" th:onclick="removeComment(this,[[${bcc.boardCommentNo}]],[[${board.boardNo}]],[[${bcc.boardCommentRef}]])">삭제</a>
                                    <a href="javascript:void(0)" class="edit right" th:onclick="editComment(this,[[${bcc.boardCommentNo}]],[[${board.boardNo}]],[[${bcc.boardCommentRef}]])">수정</a>
                                </th:block>
                            </p>
                            <p class="content-both reComment-content-list content-hover" th:text="${bcc.boardCommentContent}"></p>
                        </div>

                    </div>

                </div>

            </th:block>
                

        </div>
            
            
    </div>   

                <th:block th:include="common/bottom"></th:block>
                
                

    <script>
            
        moreComment();
        function moreComment(){
            const longComment = $(".content-both");
            longComment.each(function(index,item){
                const longCommentHeight = $(item).css("height");
                if(longCommentHeight === '110px'){
                    $(item).removeClass("short-content");
                    const more = $("<button class='more size-btn'>더보기</button>");
                    $(item).append(more);
                }
            });//댓글이 긴 경우 더보기 버튼 추가(우측 하단)
            $(".more").on("click",function(){
                $(this).parent().css("max-height","1000px");
                reduceComment($(this).parent());
                $(this).remove();
            })//더보기 버튼 누르면 max-height를 늘려서 긴 댓글을 다 볼 수 있게 해줌
        }
        

        function reduceComment(longItem){
            const reduce = $("<button class='reduce size-btn'>줄이기</button>")
            longItem.append(reduce);
            $(".reduce").on("click",function(){
                $(this).parent().css("max-height","110px");
                moreComment();
                $(this).remove();
            })
        }

        addShortComment();
        function addShortComment(){
            const content = $(".content-both");
            content.each(function(index,item){
                if($(item).height() !== 110){
                    $(item).addClass("short-content");
                }
            });

        }


        //답글누르면 답글 쓸 수 있는 거랑 답글들 리스트 뜨기
        $(".getReComment").on("click",function(){
            getReComment($(this));
        })//답글 버튼 누르면 답글달 수 있는 textarea랑 해당 댓글에 대한 답글 리스트들이 뜸

        //더보기/줄이기  버튼에 hover하면 댓글창이 가지고 있는 content-hover를 없애기
        //그래야 버튼을 hover했을때 버튼의 투명도가 내려가지 않음
        $(".size-btn").on("mouseenter",function(){
            $(this).parent().removeClass("content-hover");
            $(this).on("mouseleave",function(){
                $(this).parent().addClass("content-hover");
            })
        })

        function getReComment(thisbtn){
            //this로 받아온 thisbtn을 btn으로 바꾸고 item으로 다시 바꿔줘야 기존 코드 그대로 사용 가능
            $(".cancel").click();
            const btn = thisbtn;
            const item = $(btn);
            $(".getReComment").parent().parent().css("border-bottom","1px solid #ccc");
            $(".getReComment").not(item).prev().show();
            $(".getReComment").not(item).text("답글");

            $(".getReComment").not(item).prev().prev().prev().show();
            $(".getReComment").not(item).prev().prev().show();
            $(".getReComment").not(item).prev().show();

            $(".getReComment").not(item).parent().parent().next().children("div").hide();
            if(item.text() === "답글"){
                item.text("그만보기");
                item.prev().prev().prev().hide();
                item.prev().prev().hide();
                item.prev().hide();
                item.parent().parent().next().children("div").show();
                // 답글 보여주기
                item.parent().parent().next().children("div").next().children("div").show();
                //디자인 이슈로 답글 누르면 그 댓글 border bottom 지우기
                item.parent().parent().css("border-bottom","none");
            }
            else{
                
                item.text("답글");
                item.prev().prev().prev().show();
                item.prev().prev().show();
                item.prev().show();
                item.parent().parent().next().children("div").hide();
                item.parent().parent().next().children("div").next().children("div").hide();
                item.parent().parent().css("border-bottom","1px solid #ccc");
            }
        }

        function editComment(item, boardCommentNo, boardNo, boardCommentRef){
            //수정버튼 누르면
            //수정버튼은 수정완료로, 삭제버튼은 수정취소 버튼으로 변경
            //먼저 그 글의 높이 값을 구해와야 하는데 더보기 버튼을 강제로 누른 후 구하기
            $(item).parent().next().children(".more").click();
            let height = $(item).parent().next().height();
            if(height < 100){
                height = 100; 
            }
            //다른 수정 버튼들 다시 되돌리기
            $(".cancel").click();

            //답글같은경우 item parent parent 해서 그거 border bottom 없애기

            //원본글은 display none으로 복사해서 editContent에 append
            //이후 작성자가 취소 누르면 이 글의 텍스트를 복사해서 붙이고 copy된거 지우기
            const originalContent = $(item).parent().next().clone();
            originalContent.attr("display","none");
            originalContent.addClass("copy");

            const pContent = $(item).parent().next();
            let editContent;
            if(boardCommentRef === 0){
                //댓글인 경우 클래스에 left를 넣어줘야 함
                editContent = $("<textarea class='edit-comment-content left'>");
            }
            else{
                editContent = $("<textarea class='edit-comment-content'>");
            }
            editContent.height(height);
            editContent.val(pContent.text());
            pContent.replaceWith(editContent);

            editContent.append(originalContent);

            $(item).text("완료");
            $(item).attr("onclick","editComplete(this, "+boardCommentNo+","+boardNo+","+boardCommentRef+")")
            $(item).prev().text("취소");
            $(item).prev().attr("onclick","editCancel(this, "+boardCommentNo+","+boardNo+","+boardCommentRef+")")
            $(item).prev().addClass("cancel");
        }

        function editComplete(item, boardCommentNo, boardNo, boardCommentRef){
            //수정완료 버튼을 눌렀음

            //비동기 처리  
            const commentContent = $(item).parent().next().val();
                $.ajax({
                    url : "/board/updateComment",
                    type : "post",
                    data : {commentContent : commentContent, boardCommentNo : boardCommentNo, boardNo : boardNo},
                    success: function(data){
                        if(data > 0){
                            const edited = 1;
                            editCancel(item, boardCommentNo, boardNo, boardCommentRef, edited);
                            $(item).parent().next().text(commentContent);
                            $(item).text("수정");
                            $(item).attr("onclick","editComment(this, "+boardCommentNo+","+boardNo+","+boardCommentRef+")")
                            $(item).prev().text("삭제");
                            $(item).prev().attr("onclick","removeComment(this, "+boardCommentNo+","+boardNo+","+boardCommentRef+")")
                            $(item).prev().removeClass("cancel");
                            alert("수정이 완료되었습니다");
                            //나중에 swal로
                            //writer를 구해오고 after에 (수정) 넣기
                            const writer = $(item).prevAll(".writer");
                            const ifEdited = $(item).prevAll(".edited").is(".edited");
                            if(!ifEdited){
                                //만약에 이미 수정된 적이 있는 글이면 (수정) 이라는 글씨를 안 붙이기 위함
                                console.log(boardCommentRef);
                                if(boardCommentRef === undefined){
                                    //댓글인 경우 left를 넣어야 함
                                    writer.after("<div class='edited left'>(수정)</div>");
                                }
                                else{
                                    writer.after("<span class='edited'>(수정)</span>");
                                }
                            }
                        }
                        else{
                            console.log("댓글 수정 실패");
                        }
                    },
                    error : function(){
                        //에러
                        console.log("에렁");
                    }
                });
        }
        function editCancel(item, boardCommentNo, boardNo, boardCommentRef, edited){
            //수정 취소 버튼을 눌렀으므로 다시 원상복구
            const copyContent = $(".copy").text();
            const editContent = $(item).parent().next();
            if(boardCommentRef !== 0){
                //답글인 경우
                const pContent = $("<p class='reComment-content-list content-hover short-content content-both'></p>");
                pContent.text(copyContent);
                editContent.replaceWith(pContent);
                moreComment();
            }
            else{
                //댓글인 경우
                const pContent = $("<div class='comment-list-content content-hover short-content content-both left'></div>")
                pContent.text(copyContent);
                editContent.replaceWith(pContent);
                moreComment();
            }

            if(edited !== 1) {
                $(item).next().text("수정");
                $(item).next().attr("onclick","editComment(this, "+boardCommentNo+","+boardNo+","+boardCommentRef+")")
                $(item).text("삭제");
                $(item).attr("onclick","removeComment("+boardCommentNo+")")
                $(item).removeClass("cancel");
            }
        }

        function removeComment(item, boardCommentNo, boardNo, boardCommentRef){
            //댓글 삭제
            let getReCommentCount = $(item).parents(".reComment-input-wrap").prev().find(".getReCommentCount");
            $.ajax({
                url : "/board/removeComment",
                type : "post",
                data : {boardCommentNo : boardCommentNo},
                success : function(data){
                    $(item).parent().parent().next().remove();
                    $(item).parent().parent().remove();
                    alert("댓글이 삭제되었습니다");
                    //나중에 swal
                    if(boardCommentRef !== 0){
                        getReCommentCount.text(getReCommentCount.text()-1);

                    }
                },
                error : function(){
                    console.log("error");
                }
            });
        }

        const memberNo = [[${session.member.memberNo}]];
        const memberNickName = "[[${session.member.memberNickName}]]";
        const boardNo = [[${board.boardNo}]];


        function addComment(item){
            const memberNo = $(item).prev().val();
            const boardNo = $(item).prev().prev().val();
            const content = $(item).prev().prev().prev().val();
            
            //만약 대댓을 다는거면 여기에도 값이 있음 if~
            let boardCommentRef = $(item).prev().prev().prev().prev().val();
            if(boardCommentRef === undefined){
                //만약에 답글이면은 ~
                boardCommentRef = 0;
            }
            


            //댓글 추가 비동기
            $.ajax({
                url : "/board/comment",
                type : "post",
                data : {memberNo : memberNo , boardNo : boardNo, boardCommentContent : content, boardCommentRef : boardCommentRef},
                success : function(data){
                        if(data != null){
                            alert("댓글 추가 성공");
                            $(item).prev().prev().prev().val("");
                            const comment = data.comment;

                            // <div class="edited left">${comment.boardEdit == 1 ? '(수정)' : ''}</div>
                            // 원래 nickname 밑에 있었
                            if(boardCommentRef === 0){
                                const addedComment = `
                                    <div class="comment-list-wrap">
                                        <div class="comment-writer left">
                                        <div class="writer left">${memberNickName}</div>

                                        <div class="date left">${comment.boardCommentDate}</div>
                                        <span class="right">)</span>
                                        <span class="getReCommentCount right">${comment.reCommentCount}</span>
                                        <span class="right">(</span>
                                        <a href="javascript:void(0)" class="getReComment right">답글</a>
                                        <a href="javascript:void(0)" class="remove right" onclick="removeComment(this, ${comment.boardCommentNo}, ${boardNo})">삭제</a>
                                        <a href="javascript:void(0)" class="edit right" onclick="editComment(this, ${comment.boardCommentNo}, ${boardNo})">수정</a>
                                        </div>
                                        <div class="content-both comment-list-content content-hover left short-content">${comment.boardCommentContent}</div>
                                    </div>`;
    
                                const reComment = `
                                    <div class="reComment-input-wrap">
                                        <div class="reCommentBox">
                                            <div class="reComment-content">
                                                <input type="hidden" name="boardCommentRef" value="${comment.boardCommentNo}">
                                                <textarea name="boardCommentContent" class="left"></textarea>
                                                <input type="hidden" name="boardNo" value="${boardNo}">
                                                <input type="hidden" name="memberNo" value="${memberNo}">
                                                <button type="button" class="reComment-submit left" onclick="addComment(this)">답글</button>
                                            </div>
                                        </div>
        
                                    </div>`;


                                const commentList = $(".comment-list");

                                commentList.prepend(reComment);
                                commentList.prepend(addedComment);
                                moreComment();

                                const getReCommentBtn = $(".comment-list-wrap:first-child .getReComment");
                                //답글 버튼 누르면 동작할 수 있게 다시 기능을 넣기
                                // const getReCommentBtn = $(".getReComment");
                                getReCommentBtn.attr("onclick","getReComment(this)")

                            }
                            else if(boardCommentRef !== 0){
                                //답글을 달았으므로 답글 보여주기 (댓글쪽이 아니라 답글쪽으로)
                                const reCommentContent = `
                                    <div class="reComment-list-wrap">
                                        <div class="reComment-list">
                                            <p class="comment-info">
                                                <span class="writer">${memberNickName}</span>
                                                <span class="rcDate">${comment.boardCommentDate}</span>
                                                <a href="javascript:void(0)" class="remove right" onclick="removeComment(this,${comment.boardCommentNo},${boardNo},${comment.boardCommentRef})">삭제</a>
                                                <a href="javascript:void(0)" class="edit right" onclick="editComment(this,${comment.boardCommentNo},${boardNo},${comment.boardCommentRef})">수정</a>
                                            </p>
                                            <p class="content-both reComment-content-list content-hover short-content">${comment.boardCommentContent}</p>
                                        </div>
                                    </div>`;
                                    const reCommentBox = $(item).parent().parent();
                                    reCommentBox.after(reCommentContent);
                                    moreComment();
                                    $(item).parents(".reComment-input-wrap").prev().find(".getReComment").click();
                                    let getReCommentCount = $(item).parents(".reComment-input-wrap").prev().find(".getReComment").prev().prev().text();
                                    getReCommentCount = Number(getReCommentCount)+1;
                                    $(item).parents(".reComment-input-wrap").prev().find(".getReComment").prev().prev().text(getReCommentCount);
                            }
                        }//if
                        else{
                            alert("댓글 작성 실패");
                        }
                },
                error : function(){
                    console.log("error");
                }
            })
        }//댓글 추가

        //게시글 수정
        function boardEdit(boardNo, boardTitle, boardContent){
            location.href = "/board/editFrm?boardNo="+boardNo;
        }

        //게시글 삭제
        function boardDelete(boardNo){
            swal({
                title : "삭제",
                text : "게시글을 삭제하시겠습니까?",
                icon : "warning",
                buttons:{
                    cancel:{
                        text:"취소",
                        value:false,
                        visible:true,
                        closeModal: true
                    },
                    confirm:{
                        text:"삭제",
                        value:true,
                        visible:true,
                        closeModal:true
                    }
                }
            }).then(function(isConfirm){
                if(isConfirm){
                    location.href="/board/delete?boardNo="+boardNo;
                }
            });
        }


        ////좋아요 및 북마크 기능
        function pushLike(obj, boardNo){
            const text = $(obj).text();
            //좋아요 누르면0 취소면 1
            const isLike = (text == "favorite_border") ? 0 : 1;
            
            $.ajax({
                url : "/board/like",
                type : "post",
                data : {isLike : isLike , boardNo : boardNo},
                success : function(data){
                    if(data == -1){
                        alert("로그인 후 이용 가능합니다.");
                    }
                    else if(data == 1){
                        console.log("성공");
                        if(isLike == 0) $(obj).text("favorite");
                        else $(obj).text("favorite_border");
                    }
                    else if(data == 0){
                        alert("실패")
                    }
                },
                error : function(){
                    console.log("error");
                }
            });
        }

        function pushBookMark(obj, boardNo){
            const textBookMark = $(obj).text();
            const isBookMark = (textBookMark == "bookmark_border") ? 0 : 1;

            $.ajax({
                url : "/board/bookmark",
                type : "post",
                data : {isBookMark : isBookMark, boardNo : boardNo},
                success : function(data){
                    if(data == -1){
                        alert("로그인 후 이용가능합니다.");
                    }
                    else if(data == 1){
                        console.log("성공");
                        if(isBookMark == 0) $(obj).text("bookmark");
                        else $(obj).text("bookmark_border");
                    }
                },
                error : function(){
                    console.log("error");
                }
            })

            
        }



    </script>

</body>

</html>